#!/bin/bash

if [ -z $1 ]; then
    echo -e "Usage: \"arxivPDF xxxx.xxxx\" or \"arxivPDF xxxx.xxxx [tag]\"" 
    echo -e "Papers will save to $HOME/papers/arxiv or $HOME/papers/[tag]." 
else
    if [ ! -d $HOME/papers ]; then
        mkdir -p $HOME/papers/arxiv
    fi
    find $HOME/papers -type f -name $1.pdf > /dev/null 2>&1
    if [ $? != 0 ] && [ -z $2 ]; then
        if [ ! -f $HOME/papers/arxiv/$1.pdf ]; then
            curl https://arxiv.org/pdf/$1.pdf > $HOME/papers/arxiv/$1.pdf
        fi
    elif [ $? != 0 ]; then
        if [ ! -d $HOME/papers/$2 ]; then
            mkdir $HOME/papers/$2
        fi
        find $HOME/papers -type f -name $1.pdf > /dev/null 2>&1
        if [ $? != 0 ]; then
            curl https://arxiv.org/pdf/$1.pdf > $HOME/papers/$2/$1.pdf
        elif [ ! -f $HOME/papers/$2/$1.pdf ]; then
            find $HOME/papers -type f -name $1.pdf -exec mv {}  $HOME/papers/$2/$1.pdf \; 
        fi
    else
        find $HOME/papers -type f -name $1.pdf -exec mv {}  $HOME/papers/$2/$1.pdf \; 
    fi
    find $HOME/papers -type f -name $1.pdf -exec zathura {} \; 
fi
